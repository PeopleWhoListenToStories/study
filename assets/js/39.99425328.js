(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{157:function(t,s,e){"use strict";e.r(s);var r=e(0),a=Object(r.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"content"},[e("h1",{attrs:{id:"progressive-web-application"}},[t._v("Progressive Web Application")]),t._v(" "),e("h2",{attrs:{id:"背景"}},[t._v("背景")]),t._v(" "),e("p",[t._v("PWA 全称是渐进式 web 应用，它是用一系列前端技术来实现的，目标是提供类似原生APP一样的体验。")]),t._v(" "),e("h3",{attrs:{id:"解决的问题："}},[t._v("解决的问题：")]),t._v(" "),e("ul",[t._m(0),t._v(" "),t._m(1),t._v(" "),e("li",[t._v("Device API 的不完善\n"),e("ul",[e("li",[t._v("Native App 更方便访问设备硬件和设备上的数据")]),t._v(" "),e("li",[e("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/WebAPI",target:"_blank",rel:"noopener noreferrer"}},[t._v("WebAPI的推进"),e("OutboundLink")],1)])])])]),t._v(" "),e("h3",{attrs:{id:"关键时间节点："}},[t._v("关键时间节点：")]),t._v(" "),t._m(2),t._v(" "),e("h2",{attrs:{id:"什么是pwa"}},[t._v("什么是PWA")]),t._v(" "),e("h3",{attrs:{id:"主要特点"}},[t._v("主要特点")]),t._v(" "),t._m(3),t._v(" "),e("h3",{attrs:{id:"使用pwa的基本要求"}},[t._v("使用pwa的基本要求")]),t._v(" "),t._m(4),t._v(" "),e("h3",{attrs:{id:"对比传统-web-app，native-app-和-pwa"}},[t._v("对比传统 Web App，Native App 和 PWA")]),t._v(" "),t._m(5),t._v(" "),e("h2",{attrs:{id:"pwa的核心技术"}},[t._v("PWA的核心技术")]),t._v(" "),e("h3",{attrs:{id:"web-app-manifest"}},[t._v("Web App Manifest")]),t._v(" "),t._m(6),t._v(" "),e("h3",{attrs:{id:"service-worker"}},[t._v("Service Worker")]),t._v(" "),t._m(7),t._v(" "),e("h3",{attrs:{id:"离线通知"}},[t._v("离线通知")]),t._v(" "),t._m(8),t._v(" "),e("h2",{attrs:{id:"service-worker-2"}},[t._v("service worker")]),t._v(" "),e("h3",{attrs:{id:"作用域"}},[t._v("作用域")]),t._v(" "),t._m(9),t._v(" "),e("h3",{attrs:{id:"更新策略"}},[t._v("更新策略")]),t._v(" "),e("p",[t._v("浏览器通过自身 diff 算法能够检测 service work 的更新包含两种方式")]),t._v(" "),t._m(10),t._v(" "),e("h3",{attrs:{id:"生命周期"}},[t._v("生命周期")]),t._v(" "),t._m(11),t._v(" "),t._m(12),t._v(" "),e("h2",{attrs:{id:"用户留存"}},[t._v("用户留存")]),t._v(" "),e("h3",{attrs:{id:"mainfest字段详解"}},[t._v("mainfest字段详解")]),t._v(" "),t._m(13),e("p",[e("a",{attrs:{href:"https://app-manifest.firebaseapp.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("生成地址"),e("OutboundLink")],1)]),t._v(" "),e("h3",{attrs:{id:"修复ios上icon配置失效"}},[t._v("修复ios上icon配置失效")]),t._v(" "),t._m(14),e("h2",{attrs:{id:"离线存储"}},[t._v("离线存储")]),t._v(" "),e("h3",{attrs:{id:"资源请求拦截"}},[t._v("资源请求拦截")]),t._v(" "),e("h3",{attrs:{id:"本地存储管理"}},[t._v("本地存储管理")]),t._v(" "),e("h3",{attrs:{id:"预缓存方案"}},[t._v("预缓存方案")]),t._v(" "),t._m(15),t._v(" "),e("h3",{attrs:{id:"workbox"}},[t._v("workbox")]),t._v(" "),e("h2",{attrs:{id:"案例"}},[t._v("案例")]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://m.weibo.cn/",target:"_blank",rel:"noopener noreferrer"}},[t._v("微博"),e("OutboundLink")],1)])])])}),[function(){var t=this.$createElement,s=this._self._c||t;return s("li",[this._v("Web 的用户体验\n"),s("ul",[s("li",[this._v("首屏加载速度")]),this._v(" "),s("li",[this._v("网页离线无法访问")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("li",[this._v("用户留存\n"),s("ul",[s("li",[this._v("Native App 安装完毕桌面上有一个入口")]),this._v(" "),s("li",[this._v("Native App 能够通过发送通知让用户再次回到应用中来")]),this._v(" "),s("li",[this._v("Web App需要记住URL并输入地址")])])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ul",[e("li",[t._v("2014年，W3C 就公布过 Service Worker 的相关草案")]),t._v(" "),e("li",[t._v("2015年，chrome生产环境支持Service Worker")]),t._v(" "),e("li",[t._v("2018年2月，win10和edge全面支持pwa")]),t._v(" "),e("li",[t._v("2018年3月，ios11.3支持pwa")]),t._v(" "),e("li",[t._v("2019年3月，iOS 12.2 版本修复了 PWA 很多致命的体验问题，支持了 Web Share API 等")]),t._v(" "),e("li",[t._v("至今，PWA被提出到现在，已经过去了4年，通过 Service Worker，Web App Manifest 等技术的使用，不仅在体验上达到了他们的标准，同时还具有了 Web App 的产品迭代速度")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("可靠 - 即使在网络不稳定甚至断网的环境下，也能瞬间加载并展现")]),this._v(" "),s("li",[this._v("用户体验 - 快速响应，具有平滑的过渡动画及用户操作的反馈")]),this._v(" "),s("li",[this._v("用户黏性 - 和 Native App 一样，可以被添加到桌面，能接受离线通知，具有沉浸式的用户体验")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ul",[e("li",[t._v("站点需要使用 HTTPS")]),t._v(" "),e("li",[t._v("页面需要响应式，\b能够在平板和移动设备上都具有良好的浏览体验")]),t._v(" "),e("li",[t._v("所有的 URL 在断网的情况下有内容展现，不会展现浏览器默认页面")]),t._v(" "),e("li",[t._v("需要支持 Wep App Manifest，能\b被添加到桌面")]),t._v(" "),e("li",[t._v("即使在 3G 网络下，页面加载要快，可交互时间要短")]),t._v(" "),e("li",[t._v("在主流浏览器下都能正常展现")]),t._v(" "),e("li",[t._v("动画要流畅，有用户操作反馈")]),t._v(" "),e("li",[t._v("每个页面都有独立的 URL")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("table",[e("thead",[e("tr",[e("th",[t._v("应用类型")]),t._v(" "),e("th",[t._v("是否可安装")]),t._v(" "),e("th",[t._v("是否可链接访问")]),t._v(" "),e("th",[t._v("用户体验")]),t._v(" "),e("th",[t._v("用户黏性")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("传统 Web")]),t._v(" "),e("td",[t._v("无法安装")]),t._v(" "),e("td",[t._v("可链接访问")]),t._v(" "),e("td",[t._v("体验一般")]),t._v(" "),e("td",[t._v("黏性差")])]),t._v(" "),e("tr",[e("td",[t._v("Native App")]),t._v(" "),e("td",[t._v("可安装")]),t._v(" "),e("td",[t._v("不可链接访问")]),t._v(" "),e("td",[t._v("体验好")]),t._v(" "),e("td",[t._v("黏性强")])]),t._v(" "),e("tr",[e("td",[t._v("PWA")]),t._v(" "),e("td",[t._v("可安装")]),t._v(" "),e("td",[t._v("可链接访问")]),t._v(" "),e("td",[t._v("体验好")]),t._v(" "),e("td",[t._v("黏性强")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("兼容性：83%")]),this._v(" "),s("li",[this._v("技术实现：manifest.json\n开发者配置 PWA 的相关信息，应用名称、图标、启动方式、背景颜色、主题颜色等等，添加到桌面后，能够在系统中作为一个独立的 App 存在，具有启动画面、沉浸式浏览体验。未来PWA会被系统的应用商店收录，目前 Windows 10已经支持。")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ul",[e("li",[t._v("兼容性：94.25%")]),t._v(" "),e("li",[t._v("技术实现：service-work.js")]),t._v(" "),e("li",[t._v("主要功能\n"),e("ul",[e("li",[t._v("一个特殊的 worker 线程，独立于当前网页主线程，有自己的执行上下文")]),t._v(" "),e("li",[t._v("不能直接操作 DOM")]),t._v(" "),e("li",[t._v("一旦被安装，就永远存在，除非显示取消注册")]),t._v(" "),e("li",[t._v("使用到的时候浏览器会自动唤醒，不用的时候自动休眠")]),t._v(" "),e("li",[t._v("可拦截并代理请求和处理返回，可以操作本地缓存，如 CacheStorage，IndexedDB 等")]),t._v(" "),e("li",[t._v("离线内容开发者可控")]),t._v(" "),e("li",[t._v("离线期间网络期间可以在网络恢复后同步")]),t._v(" "),e("li",[t._v("能接受服务器推送的离线消息")]),t._v(" "),e("li",[t._v("必须在 HTTPS 环境下才能工作")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("兼容性：79.51%")]),this._v(" "),s("li",[this._v("技术实现：Web Push 和 Notification API")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ul",[e("li",[t._v("scope和文件所在路径控制最大作用域范围")]),t._v(" "),e("li",[t._v("尽量避免作用域污染")]),t._v(" "),e("li",[t._v("SPA注册在项目根目录")]),t._v(" "),e("li",[t._v("MPA注册单个注册在根目录")]),t._v(" "),e("li",[t._v("MPA注册多个注册在子目录")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("Service Worker 文件 URL 的更新（时间戳和版本号做查询字符串）")]),this._v(" "),s("li",[this._v("Service Worker 文件内容的更新（更新文件内容）")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:"/study/pwa/lifecycle.png",alt:"多页面"}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("install 安装成功，每次安装前先注销之前所有的service worker")]),this._v(" "),s("li",[this._v("active 激活成功")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-js line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[t._v("short_name"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("应用展示的名称")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("桌面上显示的名称"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nicons"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" 定义不同尺寸的应用图标\n\nstart_url"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" 定义桌面启动的 "),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("URL")]),t._v("\n\ndescription"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" 应用描述，可以参考 meta 中的 description\n\ndisplay"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" 定义应用的显示方式，有 "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" 种显示方式，分别为：\n\n    fullscreen"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" 全屏\n\n    standalone"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" 应用\n\n    minimal"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("ui"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" 类似于应用模式，但比应用模式多一些系统导航控制元素，但又不同于浏览器模式\n\n    browser"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" 浏览器模式，默认值\n\nname"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" 应用名称（浏览器提示用户添加和Android启动屏显示的名称）\n\norientation"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" 定义默认应用显示方向，竖屏、横屏\n\nbackground_color"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" 应用加载之前的背景色，用于应用启动时的过渡\n\ntheme_color"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" 定义应用默认的主题色\n\ndir"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" 文字方向，"),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" 个值可选 "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("ltr")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("left"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("to"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("right"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("rtl")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("right"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("to"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("left"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" 和 "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("auto")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("浏览器判断"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("，默认为 auto\n\nscope"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" 定义应用模式下的路径范围，超出范围会已浏览器方式显示\n\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br"),e("span",{staticClass:"line-number"},[t._v("14")]),e("br"),e("span",{staticClass:"line-number"},[t._v("15")]),e("br"),e("span",{staticClass:"line-number"},[t._v("16")]),e("br"),e("span",{staticClass:"line-number"},[t._v("17")]),e("br"),e("span",{staticClass:"line-number"},[t._v("18")]),e("br"),e("span",{staticClass:"line-number"},[t._v("19")]),e("br"),e("span",{staticClass:"line-number"},[t._v("20")]),e("br"),e("span",{staticClass:"line-number"},[t._v("21")]),e("br"),e("span",{staticClass:"line-number"},[t._v("22")]),e("br"),e("span",{staticClass:"line-number"},[t._v("23")]),e("br"),e("span",{staticClass:"line-number"},[t._v("24")]),e("br"),e("span",{staticClass:"line-number"},[t._v("25")]),e("br"),e("span",{staticClass:"line-number"},[t._v("26")]),e("br"),e("span",{staticClass:"line-number"},[t._v("27")]),e("br"),e("span",{staticClass:"line-number"},[t._v("28")]),e("br"),e("span",{staticClass:"line-number"},[t._v("29")]),e("br"),e("span",{staticClass:"line-number"},[t._v("30")]),e("br")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-js line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("link rel"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"apple-touch-icon"')]),t._v(" href"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/img/mobile-homescrenn-192x192.png"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ul",[e("li",[t._v("Network First")]),t._v(" "),e("li",[t._v("Cache First")]),t._v(" "),e("li",[t._v("Network Only")]),t._v(" "),e("li",[t._v("Cache Only")]),t._v(" "),e("li",[t._v("Stale While Revalidate")])])}],!1,null,null,null);s.default=a.exports}}]);